<!doctype html><html lang=ja><head><meta charset=utf-8><title>設定画面のあれやこれや</title>
<meta name=description content="Don't take your glasses off."><script async src="https://www.googletagmanager.com/gtag/js?id=G-RTC3ZY943S"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-RTC3ZY943S")</script><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://blog.keiji.dev/index.xml title=めがねをかけるんだ><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.keiji.dev/images/logo.png"><meta name=twitter:title content="設定画面のあれやこれや"><meta name=twitter:description content=" 「みんなのコミック」は2018年10月31日を持ちまして更新を終了いたしました。 この記事は「みんコミ Advent Calendar」の５日目の記事です。
「みんコミ」のAndroidアプリ（バージョン1.0.1）をベースに執筆しています。スクリーンショットは極力控える方針ですので、本記事を読む際には、「Google Play Store」からアプリをインストールしておくことをお勧めします。
（公開終了しています）"><link rel=stylesheet href=https://blog.keiji.dev/fontawesome/css/all.min.css><link crossorigin=anonymous href=https://blog.keiji.dev/css/styles.min.css integrity rel="preload stylesheet" as=style><link rel=stylesheet href=https://blog.keiji.dev/css/default.css><link id=dark-mode-theme crossorigin=anonymous href=https://blog.keiji.dev/css/dark.min.css integrity rel="preload stylesheet" as=style><script>var darkTheme=document.getElementById("dark-mode-theme"),storedTheme=localStorage.getItem("dark-mode-storage");storedTheme==="dark"?darkTheme.disabled=!1:storedTheme==="light"&&(darkTheme.disabled=!0)</script><script defer crossorigin=anonymous src=https://blog.keiji.dev/js/theme.js integrity></script><script defer crossorigin=anonymous src=https://blog.keiji.dev/js/instantpage.min.js integrity></script><meta name=generator content="Hugo 0.133.0"></head><body><header><nav class=navbar><div class=nav><a href=https://blog.keiji.dev/ class=nav-logo><img src=https://blog.keiji.dev/images/logo.png width height alt=Logo></a><ul class=nav-links><li><a href=https://blog.keiji.dev/profile/ id=Profile><em class="fas fa-user fa-lg"></em></a></li><li><a href=https://blog.keiji.dev/licenses/ id=Licenses><em class="fab fa-osi fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=post-heading><h1>設定画面のあれやこれや</h1><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;2015-12-04
&nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
<a href=https://blog.keiji.dev/categories/android/>Android</a>&nbsp;
<a href=https://blog.keiji.dev/categories/%E3%81%BF%E3%82%93%E3%82%B3%E3%83%9F-advent-calendar/>みんコミ Advent Calendar</a>&nbsp;</span></div></div></div></header><div class=container role=main><article class=article class=blog-post><hr><h2 id=みんなのコミックは2018年10月31日を持ちまして更新を終了いたしましたhttpstwittercommincomi_jpstatus1057847395889737730><strong><a href=https://twitter.com/mincomi_jp/status/1057847395889737730>「みんなのコミック」は2018年10月31日を持ちまして更新を終了いたしました。</a></strong></h2><p>この記事は「<a href=http://qiita.com/advent-calendar/2015/mincomi>みんコミ Advent Calendar</a>」の５日目の記事です。</p><p>「<a href=https://www.mincomi.jp>みんコミ</a>」のAndroidアプリ（バージョン1.0.1）をベースに執筆しています。スクリーンショットは極力控える方針ですので、本記事を読む際には、「Google Play Store」からアプリをインストールしておくことをお勧めします。</p><p><a href="https://play.google.com/store/apps/details?id=jp.ebookjapan.mincomi&amp;hl=ja"><img src=https://blog.keiji.dev/wp-content/uploads/2015/12/en_generic_rgb_wo_60.png alt=en_generic_rgb_wo_60 width=172 height=60 class="aligncenter size-full wp-image-672"></a>（公開終了しています）</p><hr><p>ホーム画面からメニューの「その他」をタップすると、設定画面が表示されますが、この画面が独自の画面として実装されているのが気になりました。</p><p>この内容だとPreferenceを使った方が実装もメンテナンスも簡単で、見た目もAndroid標準に則っていてユーザーに混乱を与えないと思います。</p><p><a href=http://developer.android.com/intl/ja/guide/topics/ui/settings.html>http://developer.android.com/intl/ja/guide/topics/ui/settings.html</a></p><p><a href=https://blog.keiji.dev/wp-content/uploads/2015/12/mincomi_pref1.png><img src=https://blog.keiji.dev/wp-content/uploads/2015/12/mincomi_pref1.png alt=mincomi_pref1 width=25% height=25% style=float:left></a></p><p><a href=https://blog.keiji.dev/wp-content/uploads/2015/12/mincomi_pref2.png><img src=https://blog.keiji.dev/wp-content/uploads/2015/12/mincomi_pref2.png alt=mincomi_pref2 width=25% height=25%></a></p><p>メニューの初期画面「pref_general.xml」は次の通りです。</p><pre><code class=xml>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"&gt;

    &lt;PreferenceCategory
        android:title="サービスにログイン"&gt;
        &lt;Preference
            android:title="ログイン"/&gt;
        &lt;Preference
            android:title="会員登録"/&gt;

    &lt;/PreferenceCategory&gt;

    &lt;PreferenceCategory
        android:title="その他"&gt;
        &lt;Preference
            android:title="お知らせ"/&gt;
        &lt;Preference
            android:key="various"
            android:title="設定"/&gt;
        &lt;Preference
            android:title="ヘルプ"/&gt;
        &lt;Preference
            android:title="お問い合わせ"/&gt;
        &lt;Preference
            android:title="サービスについて"/&gt;
        &lt;Preference
            android:title="利用規約"/&gt;
        &lt;Preference
            android:title="個人情報保護指針"/&gt;

    &lt;/PreferenceCategory&gt;

&lt;/PreferenceScreen&gt;
</code></pre><p>実際にはそれぞれのPreferenceから別の画面に遷移することになります。</p><p>本来であれば、Preferenceの<code>android:fragment</code>属性でPreferenceをタップした際に遷移するFragmentを指定できるのですが、それが有効なのは読み込むActivityがPreferenceActivityを継承している場合です。</p><p>今回、<code>SettingActivity</code>は、Design Support Libraryとの兼ね合いでAppCompatActivityを継承しているため、OnPreferenceClickListenerで処理しています。</p><pre><code class=java>    public static class GeneralSettingFragment extends PreferenceFragment
            implements Preference.OnPreferenceClickListener {

        @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);

            addPreferencesFromResource(R.xml.pref_general);

            findPreference("various").setOnPreferenceClickListener(this);
        }

        public static GeneralSettingFragment newInstance() {
            return new GeneralSettingFragment();
        }

        @Override
        public boolean onPreferenceClick(Preference preference) {

            switch (preference.getKey()) {
                case "various":
                    getFragmentManager()
                            .beginTransaction()
                            .addToBackStack(OtherSettingFragment.class.getSimpleName())
                            .replace(android.R.id.content, OtherSettingFragment.newInstance(),
                                    OtherSettingFragment.class.getSimpleName())
                            .commit();
                    break;
            }

            return false;
        }
    }
</code></pre><p>「その他 – 設定」をタップしたときに別の画面に遷移するようにしています。</p><p>表示する「pref_other.xml」は次の通りです。</p><pre><code class=xml>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"&gt;

    &lt;Preference
        android:summary="一時保存のデータを削除して空き容量を増やします"
        android:title="キャッシュのクリア"/&gt;

    &lt;SwitchPreference
        android:key="notification"
        android:summary="お気に入りの作品が更新されたときに通知でお知らせします"
        android:title="通知"/&gt;

    &lt;Preference
        android:key="version"
        android:title="バージョン情報"/&gt;

&lt;/PreferenceScreen&gt;
</code></pre><p>さて、Preferenceで作った画面に「最終閲覧」がないことにお気づきかと思います。</p><p>「最終閲覧」は、Preferenceを頑張ってカスタマイズすれば（おそらく）表示できます。今回、僕がそれをしていない理由は、一つはPreferenceのカスタマイズは作業の負荷が高くなりがちなこと、また、個人的に「最終閲覧」の表示は「その他」ではなく、ホーム画面にあった方が良いと思うからです。</p><p>Huluなどでも視聴中の番組は、まずトップ画面に出てきます。アプリを起動してすぐに表示されるホーム画面に表示した方がユーザーの目に留まりやすいと考えます。</p><p>サンプルプロジェクトを<a href=https://github.com/keiji/adventcalendar_2015_mincomi>GitHub</a>に置いておきます。</p><p><a href=https://github.com/keiji/adventcalendar_2015_mincomi>https://github.com/keiji/adventcalendar_2015_mincomi</a></p><hr><pre><code>「有山圭二」は「みんなのコミック」及び運営の「株式会社イーブックイニシアティブジャパン」とは一切関係がありません。
また、本アドベントカレンダーの内容はあくまで参加者個人の見解です。
「みんなのコミック」の評価を目的とするものではありませんので、ご了承下さい。
</code></pre><hr><p><a href=https://www.mincomi.jp>みんコミ</a>といえば、僕が普段からお世話になっている根雪れい（@neyuki_rei）さんも連載していますね。</p><blockquote class=twitter-tweet lang=ja><p lang=ja dir=ltr>10歳になったおかあさんと僕の生活をマンガにしましたよ～。見てくださいね ！　<a href=https://t.co/UfxCfaOYRZ>https://t.co/UfxCfaOYRZ</a>　 <a href="https://twitter.com/hashtag/%E3%81%BF%E3%82%93%E3%82%B3%E3%83%9F?src=hash">#みんコミ</a> <a href="https://twitter.com/hashtag/%E3%81%BF%E3%82%93%E3%81%AA%E3%81%AE%E3%82%B3%E3%83%9F%E3%83%83%E3%82%AF?src=hash">#みんなのコミック</a> <a href=https://t.co/2nHBnFus4n>pic.twitter.com/2nHBnFus4n</a></p><p>— 根雪れい.おかあさん(10)と僕。連載中 (@neyuki_rei)</p><p><a href=https://twitter.com/neyuki_rei/status/664369017038110720>2015, 11月 11</a></p></blockquote><p>根雪さんの「おかあさん(10)と僕。」は……まだ更新されていませんか。そうですか。</p><p>それでは代わりにもう一つ、「みんコミ」で気になっている作品を紹介します。</p><blockquote class=twitter-tweet lang=ja><p lang=ja dir=ltr>【次回更新予定】12月1日火曜日は爽田するめ先生の『育児しんどいマンガ-もうママって呼ばないで』2話が公開！育児の様々な面を本音で伝えます。子育て…難しい(^_^;) <a href="https://twitter.com/hashtag/%E3%81%BF%E3%82%93%E3%82%B3%E3%83%9F?src=hash">#みんコミ</a> <a href=https://t.co/4FRvZFqq9G>https://t.co/4FRvZFqq9G</a> <a href=https://t.co/WpcVcj3DAI>pic.twitter.com/WpcVcj3DAI</a></p><p>&mdash; みんなのコミック（みんコミ） (@mincomi_jp) <a href=https://twitter.com/mincomi_jp/status/670193289677529088>2015, 11月 27</a></p></blockquote><p>「子育てもの」というジャンルは、自分がその立場になってみないと、なかなか面白さがわからないものですね……。</p><p>わかります。ええ、わかりますとも。</p><hr><p>それでは明日、６日の担当は、今月で１才の誕生日を迎える息子さんが、最近、アニメの「ゆるゆり」にハマっていて、さっそく将来が心配になっている「有山圭二」さんです。</p><p>よろしくお願いいたします。</p></article></div><footer><div class=social-icons></div><div class=container><p class="credits copyright"><a href=https://blog.keiji.dev/about></a>&nbsp;&copy;
2025
&nbsp;/&nbsp;
<a href=https://blog.keiji.dev/>めがねをかけるんだ</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>