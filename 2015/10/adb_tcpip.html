<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
<title>Nexus 5Xが届いた今こそ adb tcpip が見直されるべき</title>


  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-62351683-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-62351683-1');
  </script>
  


<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="alternate" type="application/rss+xml" href="https://blog.keiji.dev/index.xml" title="めがねをかけるんだ">

<link id="dark-mode-theme" rel="stylesheet" href="https://blog.keiji.dev/css/dark.css" />
<link rel="stylesheet" href="https://blog.keiji.dev/fontawesome/css/all.min.css" />


<script src="https://blog.keiji.dev/js/bundle.js"></script>
<script src="https://blog.keiji.dev/js/instantpage.js" type="module" defer></script>
<meta name="generator" content="Hugo 0.77.0" />
  </head>
  <body>
    
  




  <header>
    <nav class="navbar">
  <div class="nav">
    
      <a href="https://blog.keiji.dev/" class="nav-logo">
      <img src="https://blog.keiji.dev/images/logo.png"
           width=""
           height=""
           alt="Logo">
      </a>
    

    <ul class="nav-links">
      
        
          <li><a href="https://blog.keiji.dev/profile/" name="Profile"><i class="fas fa-user fa-lg"></i></a></li>
        
      
        
          <li><a href="https://blog.keiji.dev/licenses/" name="Licenses"><i class="fab fa-osi fa-lg"></i></a></li>
        
      
    </ul>
  </div>
</nav>

    <div class="intro-header">
      <div class="container">
        <div class="post-heading">
          
            <h1>Nexus 5Xが届いた今こそ adb tcpip が見直されるべき</h1>
          
          
            <span class="meta-post">
  <i class="fa fa-calendar-alt"></i>&nbsp;2015-10-21
  
    &nbsp;&nbsp;&nbsp;<i class="fa fa-folder-open"></i>&nbsp;
    
      <a href="https://blog.keiji.dev//categories/android/">Android</a>&nbsp;
    
      <a href="https://blog.keiji.dev//categories/%E7%BF%92%E4%BD%9C/">習作</a>&nbsp;
    
  
</span>

          
        </div>
      </div>
    </div>
  </header>


    
  <div class="container" role="main">
    <article class="article" class="blog-post">
      
    <p>今朝、Nexus 5Xが届きました。指紋センサー搭載の憎いやつです。</p>
<p><a href="https://blog.keiji.dev/wp-content/uploads/2015/10/R0004876-small.jpg"><img src="https://blog.keiji.dev/wp-content/uploads/2015/10/R0004876-small.jpg" alt="R0004876-small" width="1232" height="816" class="aligncenter size-full wp-image-574" /></a></p>
<p>で、このNexus 5X。接続端子がUSB Type Cなんです（Nexus 6Pもですが）。</p>
<p>つまり、これまで使っていたMicro USBケーブルは使えません。</p>
<p>さらにNexus 5Xの場合、Type Cのケーブルしか同梱されていないのでAmazonで事前に<a href="http://amzn.to/1LJY1bL">Type C-Aのケーブル</a>を購入したりしていたわけです。</p>
<p>そうは言ってもUSB Type Cは、まだまだ特殊なケーブル。何本も持ち歩くわけにはいきません。</p>
<p>そこで昔懐かしのネットワーク経由のadb接続をすることにしました。</p>
<p>ネットワーク経由で接続すれば、端末にUSBケーブルを繋ぐのはデバッグを始めるタイミングに限定できるのでいちいち取り出す必要がなくなります。また、複数人数で開発するときにケーブルを何本も用意しなくてもすみます（もちろん再起動したら同じ作業をする必要がありますが……）。</p>
<p>ハッカソンなどのイベントでケーブルを忘れたときにも便利ですね！</p>
<h2 id="adbコマンドによる設定">adbコマンドによる設定</h2>
<p>USBデバッグを有効にした端末と開発用PCをケーブルで接続し、ターミナルやコマンドプロンプトから、以下のコマンドを実行します。なお、<code>12345</code>は任意のポート番号に変更できます。</p>
<pre><code>$ adb tcpip 12345
restarting in TCP mode port: 12345
</code></pre>
<p>この時点で、ケーブルを取り外しても大丈夫です。</p>
<p>続いて端末のIPアドレスに向けてadb接続します。端末のIPアドレスはWi-Fiの[詳細設定]から調べることができます。</p>
<pre><code>$ adb connect 192.168.170.229:12345
connected to 192.168.170.229:12345
</code></pre>
<p>接続の際に、USBケーブルで繋いだのと同様に「このＰＣからのＵＳＢデバッグを許可するか？」を聞いてきます。「OK」を選ぶとadb接続が完了して、デバッグができるようになります。</p>
<p><a href="https://blog.keiji.dev/wp-content/uploads/2015/10/Screenshot_20151021-123557.png"><img src="https://blog.keiji.dev/wp-content/uploads/2015/10/Screenshot_20151021-123557.png" alt="Screenshot_20151021-123557" width="270" height="480" class="aligncenter size-full wp-image-575" /></a></p>
<p><strong>もし身に覚えのない状況でこの画面が表示されたら、すぐにキャンセルを押しましょう</strong></p>
<p>また、接続できない場合はポート番号が合っているか、開発用のＰＣと端末が通信できる状態にあるかを確認して下さい。特にゲストネットワークなどの場合、プライバシーフィルターなどがかかっていて直接通信できない場合があります。</p>
<p>最後に、再びUSBケーブルでの接続に切り替えるときは<code>adb usb</code>を実行します。</p>
<pre><code>$ adb usb
restarting in USB mode
</code></pre>
<p>このネットワーク経由のADB接続。最近ではADKやUSBホストを使った場合のデバッグにしか使っていませんでしたが、しばらくは多用することになりそうです。</p>
<hr>
<p>昔は、開発者向けオプション（ＵＳＢデバッグ）が有効に設定された端末は、誰でもUSBケーブルを繋いだだけ、ネットワーク経由でadb接続しただけで、デバッグできてしまっていました。</p>
<p>ネットワーク経由のadbは、ノーガードでローカルネットワークに放り出される感じで不安いっぱいでしたが、今では開発機器のフィンガープリントを表示して「信頼」を確認するので、昔よりは多少は安心して使えるようになりましたね。</p>
<p>とは言え何が起こるかわからないので、<strong>開発者向けオプション（ＵＳＢデバッグ）はこまめにOFFにしましょう！</strong></p>
<hr>
<p>追伸</p>
<p>Nikkei Linux 2015年12月号（11月7日発売）にAndroid 6.0(Marshmallow)についての記事を書きました。</p>
<p>記事中で触れるサンプルコードも公開しています。</p>
<p><a href="https://github.com/keiji/simple-marshmallow-samples">GitHub – Simple Marshmallow Samples</a></p>
<p>指紋センサー周りも実機で確認しているので興味がある人は是非、手に取ってみて下さい！</p>


      
    </article>
    
    
      
      
</div>

    <footer>
  

  <div class="container">
    <p class="credits copyright">
      <a href="https://blog.keiji.dev/about"></a>
      &nbsp;&copy;
      2020
      
      &nbsp;/&nbsp;
      <a href="https://blog.keiji.dev/">めがねをかけるんだ</a>
      
      &nbsp;&ndash;&nbsp;
      <i class="fas fa-moon" id="dark-mode-toggle"></i>

    <p class="credits theme-by">
      Powered By <a href="https://gohugo.io">Hugo</a>&nbsp;
      Theme
      <a href="https://github.com/matsuyoshi30/harbor">Harbor</a>
    </p>
    </p>
  </div>
</footer>

  </body>
</html>
